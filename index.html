<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11eRC-FL Template Builder</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-boxes"></i>
                    <h1>11eRC-FL Template Builder</h1>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="saveTemplate">
                        <i class="fas fa-save"></i> Sauvegarder
                    </button>
                    <button class="btn btn-secondary" id="loadTemplate">
                        <i class="fas fa-folder-open"></i> Charger
                    </button>
                    <button class="btn btn-secondary" id="loadPreset">
                        <i class="fas fa-magic"></i> Templates
                    </button>
                    <button class="btn btn-secondary" id="editMapping">
                        <i class="fas fa-edit"></i> Noms
                    </button>
                    <button class="btn btn-primary" id="exportTemplate">
                        <i class="fas fa-download"></i> Exporter PNG
                    </button>
                </div>
            </div>
        </header>

        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="search-section">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchIcons" placeholder="Rechercher une icône...">
                    </div>
                </div>

                <div class="categories">
                    <h3>Catégories</h3>
                    <div class="category-filters">
                        <button class="category-btn active" data-category="all">
                            <i class="fas fa-th"></i> Tout
                        </button>
                        <button class="category-btn" data-category="weapons">
                            <i class="fas fa-crosshairs"></i> Armes
                        </button>
                        <button class="category-btn" data-category="ammo">
                            <i class="fas fa-circle"></i> Munitions
                        </button>
                        <button class="category-btn" data-category="uniforms">
                            <i class="fas fa-user"></i> Uniformes
                        </button>
                        <button class="category-btn" data-category="materials">
                            <i class="fas fa-cubes"></i> Matériaux
                        </button>
                        <button class="category-btn" data-category="medical">
                            <i class="fas fa-heart"></i> Médical
                        </button>
                        <button class="category-btn" data-category="vehicles">
                            <i class="fas fa-truck"></i> Véhicules
                        </button>
                        <button class="category-btn" data-category="other">
                            <i class="fas fa-ellipsis-h"></i> Autres
                        </button>
                    </div>
                </div>

                <div class="icons-grid" id="iconsGrid">
                    <!-- Les icônes seront générées dynamiquement -->
                </div>
            </aside>

            <!-- Canvas Area -->
            <main class="canvas-area">
                <div class="canvas-header">
                    <div class="template-info">
                        <input type="text" id="templateTitle" placeholder="Nom du template..." value="11eRC-FL Stockpile Template">
                        <input type="text" id="templateSubtitle" placeholder="Description..." value="This is the content of Operational Stockpiles that the 11eRC-FL expect for each operation made by the regiment.">
                    </div>
                    <div class="canvas-controls">
                        <button class="btn btn-small" id="clearCanvas">
                            <i class="fas fa-trash"></i> Vider
                        </button>
                        <button class="btn btn-small" id="addSection">
                            <i class="fas fa-plus"></i> Ajouter Section
                        </button>
                    </div>
                </div>

                <div class="canvas" id="canvas">
                    <div class="canvas-background">
                        <div class="grid-overlay"></div>
                        <div class="drop-zone">
                            <i class="fas fa-plus-circle"></i>
                            <p>Glissez les icônes ici pour créer votre template</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Template Sections -->
        <div class="template-sections" id="templateSections">
            <!-- Les sections seront ajoutées dynamiquement -->
        </div>
    </div>

    <!-- Modal pour éditer les quantités -->
    <div class="modal" id="quantityModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Modifier la quantité</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="quantity-input">
                    <label for="itemQuantity">Quantité :</label>
                    <input type="number" id="itemQuantity" min="0" max="99999" value="1">
                </div>
                <div class="subtype-selection">
                    <label for="itemSubtype">Subtype (optionnel) :</label>
                    <select id="itemSubtype">
                        <option value="">Aucun</option>
                        <!-- Les options seront générées dynamiquement -->
                    </select>
                </div>
                <div class="subtype-preview-container hidden" id="subtypePreviewContainer">
                    <div class="subtype-preview-icon-container">
                        <img class="subtype-preview-main-icon" id="previewMainIcon" src="" alt="">
                        <img class="subtype-preview-overlay" id="previewSubtypeIcon" src="" alt="" style="display: none;">
                    </div>
                    <span class="subtype-preview-text" id="previewSubtypeText">Preview avec subtype</span>
                </div>
                <div class="item-preview">
                    <img id="previewIcon" src="" alt="">
                    <span id="previewName"></span>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelQuantity">Annuler</button>
                <button class="btn btn-primary" id="confirmQuantity">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour créer une section -->
    <div class="modal" id="sectionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Créer une nouvelle section</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="sectionName">Nom de la section :</label>
                    <input type="text" id="sectionName" placeholder="Ex: Equipment (Crate)">
                </div>
                <div class="form-group">
                    <label for="sectionColor">Couleur de bordure :</label>
                    <select id="sectionColor">
                        <option value="yellow">Jaune (Small arms)</option>
                        <option value="brown">Marron (Heavy arms)</option>
                        <option value="red">Rouge (Munitions)</option>
                        <option value="blue">Bleu (Equipment)</option>
                        <option value="green">Vert (Médical/Supplies)</option>
                        <option value="purple">Violet (Supplies)</option>
                        <option value="orange">Orange (Matériaux)</option>
                        <option value="gray">Gris (Uniformes)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelSection">Annuler</button>
                <button class="btn btn-primary" id="confirmSection">Créer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour les templates prédéfinis -->
    <div class="modal" id="presetModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Templates prédéfinis</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="preset-grid">
                    <div class="preset-item" data-preset="operation">
                        <div class="preset-preview">
                            <div class="preset-sections">
                                <div class="mini-section blue">Equipment</div>
                                <div class="mini-section gray">Uniformes</div>
                                <div class="mini-section green">Medical</div>
                                <div class="mini-section orange">Materials</div>
                            </div>
                        </div>
                        <h4>Stockpile Opération</h4>
                        <p>Template standard pour les opérations</p>
                    </div>
                    
                    <div class="preset-item" data-preset="weapons">
                        <div class="preset-preview">
                            <div class="preset-sections">
                                <div class="mini-section blue">Small Arms</div>
                                <div class="mini-section blue">Heavy Arms</div>
                                <div class="mini-section red">H.Ammo</div>
                            </div>
                        </div>
                        <h4>Arsenal Militaire</h4>
                        <p>Focalisé sur les armes et munitions</p>
                    </div>
                    
                    <div class="preset-item" data-preset="logistics">
                        <div class="preset-preview">
                            <div class="preset-sections">
                                <div class="mini-section orange">Materials</div>
                                <div class="mini-section orange">Facility</div>
                                <div class="mini-section purple">Emplacements</div>
                            </div>
                        </div>
                        <h4>Logistique & Construction</h4>
                        <p>Pour les bases et fortifications</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelPreset">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour éditer le mapping des noms -->
    <div class="modal" id="mappingModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Éditer les noms des icônes</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="mapping-search">
                    <input type="text" id="mappingSearch" placeholder="Rechercher une icône...">
                </div>
                <div class="mapping-list" id="mappingList">
                    <!-- La liste sera générée dynamiquement -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelMapping">Annuler</button>
                <button class="btn btn-danger" id="resetMapping">
                    <i class="fas fa-trash"></i> Supprimer personnalisations
                </button>
                <button class="btn btn-success" id="saveMapping">Sauvegarder</button>
                <button class="btn btn-primary" id="downloadMapping">Télécharger JSON</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
